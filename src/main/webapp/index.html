<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YouTube Link to Time</title>
</head>
<body>

    <div>

        <form name="generate_link">
            YouTube link: <input type="text" name="base_url" placeholder="https://youtu.be/abc-123_XYZ or www.youtube.com/watch?v=abc-123_XYZ"/><br />
            Minutes: <input type="text" name="minutes" placeholder="0"/><br />
            Seconds: <input type="text" name="seconds" placeholder="0"/><br />
            <button id="gen_link_btn" type="button" name="user_click">Generate</button>
        </form>

    </div>


    <span id="output_link"></span>

</body>
</html>

<script>


const checkInputLink = () => {

    let userUrl = document.generate_link.base_url.value;

    // improved from: https://www.regextester.com/94360
    let yt_regex = /^(http(s)?:\/\/)?((w){3}.)?youtu(be|.be)?(\.com)?\/(embed\/)?(watch\?.*v=([^&\s]+))?([^\s]+)?/g;


    // let wwwyt_regex = /[https?:\/\/]?[www.]?youtube\.com\/watch\?v=([^&]+)/g;
    // let ytbe_regex = /.*youtu\.be\/([^&]+)/g;

    let youTubeId = false;

    console.log(userUrl);

    if (userUrl.match(yt_regex)) {
        let vidRegex = RegExp(yt_regex);
        console.log("mathed");
        matches = vidRegex.exec(userUrl);

        // number of match groups in yt_regex
        if (matches.length === 11) {
            youTubeId = (matches[9] === undefined) ? matches[10] : matches[9];
        }

        console.log("found youTubeId -> %s", youTubeId);

    } else {
        console.log("regex match failed for URL: %s", userUrl);
    }

    return youTubeId;
}



const makeOutputLink = (youTubeId) => {

    return `https://youtu.be/${youTubeId}`;
}



const outputLink = (newLink) => {
    document.querySelector('#output_link').innerHTML = newLink;
}

const userClick = () => {
    let idOrFalse = checkInputLink();
    if (idOrFalse !== false) {

        let youTubeId = idOrFalse; // not false

        outputLink( makeOutputLink(youTubeId) );

    } else {
        console.log("problems recognizing the provided url");
    }

}

document.querySelector('#gen_link_btn').addEventListener('click', userClick);

</script>